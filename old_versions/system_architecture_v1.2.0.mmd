%% Version: 1.2.1 (Authoritative Performance Mapping)
%% Authoritative Architecture for Gillsystems Cluster

flowchart TB
  %% Top-level Cluster Topology
  subgraph Cluster["Gillsystems Commander Cluster"]
    direction TB
    
    subgraph MainNode["Gillsystems-Main (10.0.0.164:8000)"]
        direction TB
        Commander[THE COMMANDER\nMeta-Orchestrator]
        SystemMgr[System Manager]
        ComputeMain[Primary Compute\n130 t/s]
    end

    subgraph StorageNode["Gillsystems-HTPC (10.0.0.42:8001)"]
        direction TB
        Relay[Relay Server\nMessage Hub]
        ComputeHTPC[Secondary Compute\n60 t/s]
        subgraph ZFS["ZFS Dataset: /gillsystems_zfs_pool/AI_storage"]
            direction LR
            Memory[(Persistent Memory\nSQLite DB)]
            LogStore[Logs & Traceability]
        end
    end

    subgraph Workers["Tertiary Worker Nodes"]
        direction LR
        Laptop["Laptop Node\n(10.0.0.93:8002)\n9 t/s"]
        SteamDeck["Steam Deck Node\n(10.0.0.139:8003)\n30 t/s"]
    end
  end

  %% Data & Control Flows
  Commander -->|Orchestrate| Relay
  Relay -->|Route Task| ComputeHTPC
  Relay -->|Route Task| Workers
  
  Workers -->|Response| Relay
  Relay -->|Store| Memory
  Relay -->|Log| LogStore
  
  %% Style
  classDef primary fill:#003366,color:#fff,stroke:#0099cc,stroke-width:2px;
  classDef storage fill:#006633,color:#fff,stroke:#00cc66,stroke-width:2px;
  classDef worker fill:#444,color:#fff,stroke:#999,stroke-width:1px;
  
  class Commander,SystemMgr,ComputeMain primary;
  class Relay,Memory,LogStore,ZFS,ComputeHTPC storage;
  class Laptop,SteamDeck worker;
