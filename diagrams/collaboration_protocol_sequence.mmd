%% Collaboration Protocol (sequence diagram)
sequenceDiagram
    autonumber
    participant Cmd as Commander
    participant A as Architect
    participant C as Coder
    participant R as Reasoner
    participant S as Synthesizer
    participant L as Log

    Cmd->>A: MasterPrompt + RoleDef
    Cmd->>C: MasterPrompt + RoleDef
    Cmd->>R: MasterPrompt + RoleDef
    Cmd->>S: MasterPrompt + RoleDef

    A-->>L: StructuredMsg(role:Architect, payload, deps)
    A->>C: Request implementation details
    C-->>L: StructuredMsg(role:Coder, artifact, tests)

    A->>R: Ask analysis of edge cases
    R-->>L: StructuredMsg(role:Reasoner, findings, flags)

    C->>S: Hand off artifact
    R->>S: Hand off findings
    S-->>L: StructuredMsg(role:Synthesizer, merged_output, rationale)

    S->>Cmd: FinalDeliverable + Trace
    Cmd-->>L: Append full audit trail

    Note over Cmd,S: Protocol enforces required fields and validation
